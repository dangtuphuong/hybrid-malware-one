import axios from "axios";

const API_URL = "http://localhost:5000/api";

const register = async (params) => {
  try {
    const res = await axios.post(API_URL + `/register`, params);

    if (res?.status === 200 && res?.data?.user) {
      localStorage.setItem("user", JSON.stringify(res?.data?.user));
    } else {
      console.log(res.data.error);
    }
    return res?.data;
  } catch (error) {
    console.error("Error:", error);
  }
};

const login = async ({ email, password }) => {
  try {
    const res = await axios.post(API_URL + `/authenticate`, {
      email,
      password,
    });

    if (res?.status === 200 && res?.data?.user) {
      localStorage.setItem("user", JSON.stringify(res?.data?.user));
    } else {
      console.log(res.data.error);
    }
    return res?.data;
  } catch (error) {
    console.error("Error:", error);
  }
};

const logout = async () => localStorage.removeItem("user");

const getCurrentUser = () => JSON.parse(localStorage.getItem("user"));

const AuthService = { register, login, logout, getCurrentUser };

export default AuthService;
